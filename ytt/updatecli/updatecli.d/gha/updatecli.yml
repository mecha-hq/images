#! updatecli.yml

name: update updatecli versions

#@ load("fragments.lib.yml", "scm_mecha_images", "actions")
#@ load("fragments.lib.yml", "source_githubrelease")

scms:
  mecha-images: #@ scm_mecha_images()

actions: #@ actions("updatecli")

sources:
  updatecli: #@ source_githubrelease("updatecli", "updatecli", "latest")

targets:
  ytt-gha-workflows-fragments-0:
    name: Bump updatecli version
    kind: file
    sourceid: updatecli
    scmid: mecha-images
    spec:
      file: ytt/.github/workflows/fragments.lib.yml
      matchpattern: '^        version: \d+\.\d+\.\d+ \#\! updatecli version$'
      content: "        version: {{ source `updatecli` }}"
  gha-workflows-updatecli-0:
    name: Bump updatecli version
    kind: yaml
    sourceid: updatecli
    scmid: mecha-images
    spec:
      key: $.jobs.updatecli.steps[1].with.version
      file: .github/workflows/updatecli.yaml
